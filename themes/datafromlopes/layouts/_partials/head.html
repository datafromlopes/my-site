{{- $siteTitle := .Site.Title -}}
{{- $brandName := or .Site.Params.name .Site.Title -}}
{{- $isHome := .IsHome -}}
{{- $url := .Permalink -}}
{{- $desc := or .Site.Params.description "MSc in Computer Science @ IME-USP" -}}

{{- $tabTitle := "" -}}
{{- if $isHome -}}
  {{- $tabTitle = $brandName -}}
{{- else if or .IsSection .IsTaxonomy .IsTaxonomyTerm -}}
  {{- $tabTitle = printf "%s | %s" (humanize .Section) $brandName -}}
{{- else -}}
  {{- $tabTitle = printf "%s | %s" .Title $brandName -}}
{{- end -}}

{{- $ogTitle := cond $isHome $siteTitle (printf "%s | %s" (or .Title (humanize .Section) $siteTitle) $siteTitle) -}}

{{- $imgParam := .Params.image -}}
{{- $res := cond (and $imgParam (ne $imgParam "")) (.Resources.GetMatch $imgParam) nil -}}
{{- if not $res -}}
  {{- $imgs := .Resources.ByType "image" -}}
  {{- if gt (len $imgs) 0 -}}
    {{- $res = index $imgs 0 -}}
  {{- end -}}
{{- end -}}
{{- $fallback := .Site.Params.defaultImage | absURL -}}
{{- $ogimg := $fallback -}}
{{- if $res -}}
  {{- $ogimg = $res.Permalink -}}
{{- else if $imgParam -}}
  {{- $ogimg = ($imgParam | absURL) -}}
{{- end -}}

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>{{ $tabTitle }}</title>
<meta name="description" content="{{ $desc }}">
<link rel="canonical" href="{{ $url }}"/>

{{- $noindex := false -}}
{{- if or .Draft .Params.noindex -}}{{- $noindex = true -}}{{- end -}}
{{- if and .IsNode .Paginator (gt .Paginator.PageNumber 1) -}}{{- $noindex = true -}}{{- end -}}
<meta name="robots" content="{{ if $noindex }}noindex,follow{{ else }}index,follow{{ end }}"/>

<meta property="og:title" content="{{ $ogTitle }}">
<meta property="og:description" content="{{ $desc }}">
<meta property="og:url" content="{{ $url }}">
<meta property="og:site_name" content="{{ $siteTitle }}">
<meta property="og:type" content="{{ if .IsPage }}article{{ else }}website{{ end }}">
<meta property="og:image" content="{{ $ogimg }}">
{{- with $res }}
  {{- if and .Width .Height }}
    <meta property="og:image:width" content="{{ .Width }}">
    <meta property="og:image:height" content="{{ .Height }}">
  {{- end }}
{{- end }}
<meta property="og:locale" content="pt_BR">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="{{ $ogTitle }}">
<meta name="twitter:description" content="{{ $desc }}">
<meta name="twitter:image" content="{{ $ogimg }}">
<meta name="twitter:image:src" content="{{ $ogimg }}">
{{ with .Site.Params.twitter }}<meta name="twitter:site" content="{{ . }}">{{ end }}

{{ partial "jsonld.html" . }}